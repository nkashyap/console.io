/**
 * Name: console.io
 * Version: 0.2.0-1
 * Description: Javascript Remote Web Console
 * Website: http://nkashyap.github.io/console.io/
 * Author: Nisheeth Kashyap
 * Email: nisheeth.k.kashyap@gmail.com
 * Date: 2013-09-19
*/

var ConsoleIO="undefined"==typeof module?{}:module.exports;ConsoleIO.version="0.2.0-1",function(){!function(a,b){var c=a.util={},d=!1,e=[];c.getScripts=function(){return c.toArray(document.scripts||document.getElementsByName("script"))},c.getStyles=function(){return c.toArray(document.getElementsByTagName("link"))},c.getFirstElement=function(a){return a?a.firstElementChild||a.firstChild:!1},c.getOrigin=function(){return b.location.origin||b.location.protocol+"//"+(b.location.host||b.location.hostname+":"+b.location.port)},c.getHashParams=function(){var a={},d=b.location.hash||b.location.href.replace(c.getOrigin()+b.location.pathname,"");return d&&c.forEach(d.split("#"),function(b){var c=b.split("=");a[c[0]]=c[1]}),a},c.getQueryParams=function(a){a=a||b.location.href;var d={},e=a.indexOf("?");return e>-1&&c.forEach(a.substring(e+1,a.length).split("&"),function(a){var b=a.split("=");d[b[0]]=b[1]}),d},c.queryParams=function(){var a={},b=c.getScripts();return c.every(b,function(b){var d=(b.src||b.getAttribute("src")||"").toLowerCase();if(-1===d.indexOf("console.io.js"))return!0;if(a.secure=d.indexOf("https")>-1,c.extend(a,c.getQueryParams(d)),!a.url){var e=new RegExp("^(?:f|ht)tp(?:s)?://([^/]+)","im"),f=d.indexOf("?"),g=f>-1?d.substring(0,f):d;a.url=(a.secure?"https://":"http://")+g.match(e)[1].toString()}return a.base||(a.base=d.indexOf("/console.io/")>-1?"console.io/":""),!1}),c.extend(a,c.getHashParams()),a},c.checkFile=function(a){var b=a.indexOf(".js")>-1,d=a.indexOf(".css")>-1,e=b?c.getScripts():d?c.getStyles():null,f=b?"src":d?"href":null,g=!1;return e&&c.every(e,function(b){var c=b.getAttribute(f)||"";return g=c.indexOf(a)>-1,!g}),g},c.removeFile=function(a){var b,d,e=a.indexOf(".js")>-1?"script":a.indexOf(".css")>-1?"link":null;e&&(d="script"===e?"src":"href",b=document.getElementsByTagName(e),c.forEach(c.toArray(b),function(b){var c=b.getAttribute(d)||"";c.indexOf(a)>-1&&b.parentNode.removeChild(b)}))},c.requireCSS=function(a,d){if(c.checkFile(a))return d&&setTimeout(function(){d(a)},10),!1;var e=document.styleSheets.length,f=document.createElement("link"),g=document.getElementsByTagName("head")[0];if(d)var h=b.setInterval(function(){document.styleSheets.length>e&&(d(a),b.clearInterval(h))},10);f.type="text/css",f.rel="stylesheet",f.media="all",f.href=a,g.appendChild(f)},c.requireScript=function(a,d){function e(){g.removeEventListener?(g.removeEventListener("load",e,!1),d(a)):g.attachEvent&&(b.opera||"complete"!==g.readyState&&"loaded"!==g.readyState||(g.detachEvent("onreadystatechange",e),d(a)))}function f(){g.removeEventListener("error",f,!1)}if(c.checkFile(a))return setTimeout(function(){d(a)},10),!1;var g=document.createElement("script"),h=document.getElementsByTagName("head")[0];g.type="text/javascript",g.charset="utf-8",g.async=!0,b.opera||"complete"!==g.readyState&&"loaded"!==g.readyState||setTimeout(function(){d(a)},1),g.addEventListener?(g.addEventListener("load",e,!1),g.addEventListener("error",f,!1)):!g.attachEvent||g.attachEvent.toString&&g.attachEvent.toString().indexOf("[native code")<0||b.opera||(g.onload=e,g.attachEvent("onreadystatechange",e)),g.src=a,h.appendChild(g)},c.ready=function(a){function f(){d=!0,c.forEach(e,function(a){a()}),e=[]}function g(){document.addEventListener?(document.removeEventListener("DOMContentLoaded",g,!1),f()):document.attachEvent&&"complete"===document.readyState&&(document.detachEvent("onreadystatechange",g),f())}return d?(setTimeout(a,1),!1):(e.push(a),e.length>1?!1:("complete"===document.readyState&&setTimeout(f,1),document.addEventListener?(document.addEventListener("DOMContentLoaded",g,!1),b.addEventListener("load",f,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",g),b.attachEvent("onload",f)),void 0))},c.require=function(a,b){function d(a){var c=!0;i[a]=!0;for(var d in i)i[d]||(c=!1);!g&&c&&(g=!0,b())}"string"==typeof a&&(a=[a]);var e,f,g=!1,h=a.length,i={};for(e=0;h>e;e++)f=a[e],i[f]=!1,f.indexOf(".css")>-1?c.requireCSS(f,d):c.requireScript(f,d)},c.addCSSRule=function(a,b,c,d){try{a.insertRule?a.insertRule(b+"{"+c+"}",d):a.addRule&&a.addRule(b,c,d)}catch(e){}},c.deleteCSSRule=function(a,b){var d=a.cssRules||a.rules;c.forEach(c.toArray(d),function(c,d){c.selectorText&&c.selectorText.replace("::",":")===b.replace("::",":")&&(a.deleteRule?a.deleteRule(d):a.removeRule&&a.removeRule(d))})},c.getAppliedStyles=function(a){var d=document.defaultView||b,e=[];if(d.getComputedStyle){var f=d.getComputedStyle(a,"");c.forEach(c.toArray(f),function(a){e.push(a+":"+f.getPropertyValue(a))})}else a.currentStyle?c.forEachProperty(a.currentStyle,function(a,b){e.push(b+":"+a)}):c.forEach(c.toArray(a.style),function(b){e.push(b+":"+a.style[b])});return e.join("; ")},c.getUrl=function(b){var c=a.getConfig(),d=c.url,e=d.length-1,f=c[b];return"/"===d.charAt(e)&&(d=d.substr(0,e)),d+=(c.base.length>0?"/"+c.base:"/")+f},c.showInfo=function(b,d){var e="consoleio",f=d?"rgba(0, 130, 30, 0.8)":"rgba(0, 0, 0, 0.8)",g="content: 'Console.IO:"+b+"'; position: fixed; top: 0px; left: 0px; padding: 2px 8px; "+"font-size: 12px; font-weight: bold; color: lightgrey; "+"background-color: "+f+"; border: 1px solid rgb(0, 0, 0); "+"font-family: Monaco,Menlo,Consolas,'Courier New',monospace;";c.deleteCSSRule(a.styleSheet,"."+e+":after"),c.addCSSRule(a.styleSheet,"."+e+":after",g),document.body.setAttribute("class",e)},c.isIFrameChild=function(){return b.location!==b.parent.location},c.foundRequireJS=function(){return"undefined"!=typeof b.requirejs},c.foundDefine=function(){return"function"==typeof define&&define.amd},c.getType=function(a){return Object.prototype.toString.apply(a).replace("[object ","").replace("]","")},c.getFunctionName=function(a){var b;return a&&(b=a.getName instanceof Function?a.getName():a.name,b=b||a.toString().match(/function\s*([_$\w\d]*)/)[1]),b||"anonymous"},c.toArray=function(a){return Array.prototype.slice.call(a)},c.isArray=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)},c.every=function(){return Array.prototype.every?function(a,b,c){return(a||[]).every(b,c)}:function(a,b,c){a=a||[];var d=0,e=a.length;if(e)do if(!b.call(c||a,a[d],d,a))return!1;while(++d<e);return!0}}(),c.forEach=function(){return Array.prototype.forEach?function(a,b,c){(a||[]).forEach(b,c)}:function(a,b,c){a=a||[];var d=0,e=a.length;if(e)do b.call(c||a,a[d],d,a);while(++d<e)}}(),c.forEachProperty=function(a,b,c){var d;for(d in a)b.call(c||a,a[d],d,a)},c.extend=function(a,b){return c.forEachProperty(b,function(b,c){a[c]=b}),a}}("undefined"!=typeof ConsoleIO?ConsoleIO:module.exports,this),function(a){var b=a.storage={},c={};a.util.ready(function(){var b,d,e,f,g=document.cookie.split("; "),h=g.length;for(b=0;h>b;b++)d=g[b].split("="),e=d[0],f=d[1],c[e]=f;a.util.forEachProperty(c,function(b,c){"serialNumber"===c&&(a.serialNumber=b),"deviceName"===c&&(a.name=b)})}),b.addItem=function(a,b,d){if(b&&"undefined"!==b){var e="";if(d){var f=new Date;f.setTime(f.getTime()+1e3*60*60*24*d),e="; expires="+f.toGMTString()}document.cookie=a+"="+b+e+"; path=/",c[a]=b}},b.removeItem=function(a){b.addItem(a,"",-1),delete c[a]},b.getItem=function(a){return c[a]}}("undefined"!=typeof ConsoleIO?ConsoleIO:module.exports,this),function(a){function b(){}a.EventEmitter=b,b.prototype.on=function(b,c){return this.$events||(this.$events={}),this.$events[b]?a.util.isArray(this.$events[b])?this.$events[b].push(c):this.$events[b]=[this.$events[b],c]:this.$events[b]=c,this},b.prototype.addListener=b.prototype.on,b.prototype.once=function(a,b){function c(){d.removeListener(a,c),b.apply(this,arguments)}var d=this;return c.listener=b,this.on(a,c),this},b.prototype.removeListener=function(b,c){if(this.$events&&this.$events[b]){var d=this.$events[b];if(a.util.isArray(d)){for(var e=-1,f=0,g=d.length;g>f;f++)if(d[f]===c||d[f].listener&&d[f].listener===c){e=f;break}if(0>e)return this;d.splice(e,1),d.length||delete this.$events[b]}else(d===c||d.listener&&d.listener===c)&&delete this.$events[b]}return this},b.prototype.removeAllListeners=function(a){return void 0===a?(this.$events={},this):(this.$events&&this.$events[a]&&(this.$events[a]=null),this)},b.prototype.listeners=function(b){return this.$events||(this.$events={}),this.$events[b]||(this.$events[b]=[]),a.util.isArray(this.$events[b])||(this.$events[b]=[this.$events[b]]),this.$events[b]},b.prototype.emit=function(b){if(!this.$events)return!1;var c=this.$events[b];if(!c)return!1;var d=Array.prototype.slice.call(arguments,1);if("function"==typeof c)c.apply(this,d);else{if(!a.util.isArray(c))return!1;for(var e=c.slice(),f=0,g=e.length;g>f;f++)e[f].apply(this,d)}return!0}}("undefined"!=typeof ConsoleIO?ConsoleIO:module.exports,this),function(a){var b=a.stringify={};b.objects=["Arguments","Array","String","Number","Boolean","Function","Object","Geoposition","Coordinates","CRuntimeObject"],b.events=["Event","KeyboardEvent","MouseEvent","TouchEvent","WheelEvent","UIEvent","CustomEvent","NotifyAudioAvailableEvent","CompositionEvent","CloseEvent","MessageEvent","MessageEvent","XMLHttpRequestProgressEvent","ProgressEvent"],b.errors=["Error","ErrorEvent","DOMException","PositionError"],b.parse=function(c,d,e){var f="",g=a.util.getType(c);if(e="undefined"==typeof e?!0:e,d=d||1,b.objects.indexOf(g)>-1||b.events.indexOf(g)>-1||b.errors.indexOf(g)>-1)switch(g){case"Error":case"ErrorEvent":c=c.message;case"String":f=b.parseString(c);break;case"Arguments":c=a.util.toArray(c);case"Array":f=b.parseArray(c,d);break;case"Number":f=String(c);break;case"Boolean":f=c?"true":"false";break;case"Function":f='"'+a.util.getFunctionName(c)+'"';break;default:f=b.parseObject(g,c,d)}else if(null===c)f='"null"';else if(void 0===c)f='"undefined"';else if(e)f=b.parseObject(g,c,d);else try{f=String(c)}catch(h){a.console.error(h)}return f},b.valueOf=function(c,d,e){var f=a.util.getType(c);return(b.objects.indexOf(f)>-1||b.events.indexOf(f)>-1||b.errors.indexOf(f)>-1)&&!d?this.parse(c,e):("Function"===f?f="[Function "+a.util.getFunctionName(c)+"]":c&&c.constructor&&c.constructor.name&&(f="[object "+c.constructor.name+"]"),f)},b.parseString=function(a){return'"'+a.replace(/"/g,"'").replace(/</g,"&lt;").replace(/>/g,"&gt;")+'"'},b.parseArray=function(c,d){var e,f=[];return a.util.forEach(c,function(a,c){this[c]=b.valueOf(a,!1,d)},f),e=f.length>0?"[ "+f.join(", ")+" ]":"[ "+c.toString()+" ]"},b.parseObject=function(c,d,e){var f,g="",h="[object global]"===c,i=new Array(e).join("	"),j=new Array(++e).join("	"),k=[];return d&&d.constructor&&(g=d.constructor.name),a.util.forEachProperty(d,function(a,c){this.push(j+'"'+c+'": '+b.valueOf(a,h,e))},k),f=k.length>0?(g||c)+": {\n"+k.join(",\n")+"\n"+i+"}":d.toString()+"\n"}}("undefined"!=typeof ConsoleIO?ConsoleIO:module.exports,this),function(a){function b(a){for(var c=[],d=Array.prototype.slice,e=0;e<a.length;++e){var f=a[e];void 0===f?c[e]="undefined":null===f?c[e]="null":f.constructor&&(f.constructor===Array?c[e]=f.length<3?"["+b(f)+"]":"["+b(d.call(f,0,1))+"..."+b(d.call(f,-1))+"]":f.constructor===Object?c[e]="#object":f.constructor===Function?c[e]="#function":f.constructor===String?c[e]='"'+f+'"':f.constructor===Number&&(c[e]=f))}return c.join(",")}var c=a.formatter={};c.chrome=function(a){var b=(a.stack+"\n").replace(/^\S[^\(]+?[\n$]/gm,"").replace(/^\s+(at eval )?at\s+/gm,"").replace(/^([^\(]+?)([\n$])/gm,"{anonymous}()@$1$2").replace(/^Object.<anonymous>\s*\(([^\)]+)\)/gm,"{anonymous}()@$1").split("\n");return b.pop(),b},c.safari=function(a){return a.stack.replace(/\[native code\]\n/m,"").replace(/^(?=\w+Error\:).*$\n/m,"").replace(/^@/gm,"{anonymous}()@").split("\n")},c.ie=function(a){var b=/^.*at (\w+) \(([^\)]+)\)$/gm;return a.stack.replace(/at Anonymous function /gm,"{anonymous}()@").replace(/^(?=\w+Error\:).*$\n/m,"").replace(b,"$1@$2").split("\n")},c.firefox=function(a){return a.stack.replace(/(?:\n@:0)?\s+$/m,"").replace(/^[\(@]/gm,"{anonymous}()@").split("\n")},c.opera11=function(a){for(var b="{anonymous}",c=/^.*line (\d+), column (\d+)(?: in (.+))? in (\S+):$/,d=a.stacktrace.split("\n"),e=[],f=0,g=d.length;g>f;f+=2){var h=c.exec(d[f]);if(h){var i=h[4]+":"+h[1]+":"+h[2],j=h[3]||"global code";j=j.replace(/<anonymous function: (\S+)>/,"$1").replace(/<anonymous function>/,b),e.push(j+"@"+i+" -- "+d[f+1].replace(/^\s+/,""))}}return e},c.opera10b=function(a){for(var b=/^(.*)@(.+):(\d+)$/,c=a.stacktrace.split("\n"),d=[],e=0,f=c.length;f>e;e++){var g=b.exec(c[e]);if(g){var h=g[1]?g[1]+"()":"global code";d.push(h+"@"+g[2]+":"+g[3])}}return d},c.opera10a=function(a){for(var b="{anonymous}",c=/Line (\d+).*script (?:in )?(\S+)(?:: In function (\S+))?$/i,d=a.stacktrace.split("\n"),e=[],f=0,g=d.length;g>f;f+=2){var h=c.exec(d[f]);if(h){var i=h[3]||b;e.push(i+"()@"+h[2]+":"+h[1]+" -- "+d[f+1].replace(/^\s+/,""))}}return e},c.opera9=function(a){for(var b="{anonymous}",c=/Line (\d+).*script (?:in )?(\S+)/i,d=a.message.split("\n"),e=[],f=2,g=d.length;g>f;f+=2){var h=c.exec(d[f]);h&&e.push(b+"()@"+h[2]+":"+h[1]+" -- "+d[f+1].replace(/^\s+/,""))}return e},c.other=function(a){for(var c,d,e="{anonymous}",f=/function\s*([\w\-$]+)?\s*\(/i,g=[],h=10;a&&a.arguments&&g.length<h;)c=f.test(a.toString())?RegExp.$1||e:e,d=Array.prototype.slice.call(a.arguments||[]),g[g.length]=c+"("+b(d)+")",a=a.caller;return g}}("undefined"!=typeof ConsoleIO?ConsoleIO:module.exports,this),function(a){function b(){try{void 0()}catch(a){return a}}function c(b){return b.arguments&&b.stack?a.formatter.chrome:b.stack&&b.sourceURL?a.formatter.safari:b.stack&&b.number?a.formatter.ie:"string"==typeof b.message&&"undefined"!=typeof window&&window.opera?b.stacktrace?b.message.indexOf("\n")>-1&&b.message.split("\n").length>b.stacktrace.split("\n").length?a.formatter.opera9:b.stack?b.stacktrace.indexOf("called from line")<0?a.formatter.opera10b:a.formatter.opera11:a.formatter.opera10a:a.formatter.opera9:b.stack?a.formatter.firefox:"other"}var d=a.stacktrace={};d.allowedErrorStackLookUp=["Error","ErrorEvent","DOMException","PositionError"],d.get=function(e){e=e||b();var f=c(e);if("function"==typeof f)return f(e);var g=a.util.getType(e);return-1===d.allowedErrorStackLookUp.indexOf(g)?g+' is missing from "stacktrace.allowedErrorStackLookUp['+d.allowedErrorStackLookUp.join(",")+']";':a.formatter.other(arguments.callee)}}("undefined"!=typeof ConsoleIO?ConsoleIO:module.exports,this),function(a,b){function c(a){var b=a.data;m.emit(b.event,{type:b.type,message:b.message,stack:b.stack,origin:a.origin})}function d(){m.emit("setUp",a.client.getConfig()),a.console.log("Connected to the Server",arguments)}function e(b){m.connectionMode=b,m.showInfoBar("connecting",!1),a.console.log("Connecting to the Server",b)}function f(b,c){m.connectionMode=b,m.emit("online",a.client.getConfig()),a.console.log("Reconnected to the Server after "+c+" attempts.",b,c)}function g(){m.showInfoBar("reconnecting",!1),a.console.log("Reconnecting to the Server",arguments)}function h(b){m.showInfoBar("disconnect",!1),a.console.log("Disconnected from the Server",b),(!b||b&&"booted"!==b)&&m.forceReconnect()}function i(){m.showInfoBar("connection failed",!1),a.console.warn("Failed to connect to the Server",arguments)}function j(){m.showInfoBar("reconnection failed",!1),a.console.warn("Failed to reconnect to the Server",arguments)}function k(b){m.showInfoBar("connection error",!1),a.console.warn("Socket Error",b)}var l,m=a.transport={},n=[];m.connectionMode="",m.setUp=function(){!function(a){if(a.Transport["jsonp-polling"]){var b=a.Transport["jsonp-polling"].prototype.post;a.Transport["jsonp-polling"].prototype.requestQueue=[],a.Transport["jsonp-polling"].prototype.isProcessingQueue=!1,a.Transport["jsonp-polling"].prototype.hasOutstandingRequests=!1,a.Transport["jsonp-polling"].prototype.postRequest=function(){var a=this;this.isProcessingQueue=!0,setTimeout(function(){b.call(a,a.requestQueue.shift())},10)},a.Transport["jsonp-polling"].prototype.completePostRequest=function(){var a=this;setTimeout(function(){a.socket.setBuffer(!1),a.hasOutstandingRequests=a.requestQueue.length>0,a.isProcessingQueue=!1,a.processPendingRequests()},250)},a.Transport["jsonp-polling"].prototype.processPendingRequests=function(){this.hasOutstandingRequests&&!this.isProcessingQueue&&(this.postRequest(),this.completePostRequest())},a.Transport["jsonp-polling"].prototype.post=function(a){this.requestQueue.push(a),this.hasOutstandingRequests=!0,this.processPendingRequests()}}}(b.io),l=a.getConfig(),m.io=a.io.connect(l.url,{secure:l.secure,resource:l.base+"socket.io","sync disconnect on unload":!0}),a.console.on("console",function(a){m.emit("console",{type:a.type,message:escape(a.message),stack:a.stack})}),b.addEventListener?b.addEventListener("message",c,!1):b.attachEvent&&b.attachEvent("onmessage",c),m.io.on("connect",d),m.io.on("connecting",e),m.io.on("reconnect",f),m.io.on("reconnecting",g),m.io.on("disconnect",h),m.io.on("connect_failed",i),m.io.on("reconnect_failed",j),m.io.on("error",k)},m.emit=function(a,b){return m.isConnected()?(m.io.emit("device:"+a,b||{}),!0):(n.push({name:a,data:b}),!1)},m.on=function(a,b,c){m.io.on(a,function(){b.apply(c||this,arguments)})},m.isConnected=function(){return m.io&&m.io.socket?m.io.socket.connected:!1},m.forceReconnect=function(){try{m.io.socket.disconnectSync(),m.io.socket.reconnect()}catch(b){a.console.error(b)}},m.showInfoBar=function(b,c){var d=a.getConfig(),e=[];a.name&&e.push(a.name),a.serialNumber&&e.push(a.serialNumber),d.secure&&e.push("secure"),d.web&&e.push("web"),d.url&&e.push(d.url),d.base&&e.push(d.base),e.push(b),e.push(c?"online":"offline"),a.util.showInfo(e.join("|"),c)},m.clearPendingQueue=function(){var b=[];a.util.forEach(n,function(a){var c=m.emit(a.name,a.data);c||b.push(a)}),n=b}}("undefined"!=typeof ConsoleIO?ConsoleIO:module.exports,this),function(a,b){function c(b,c,g,h){e&&a.getConfig().nativeConsole&&e[b]&&(f.indexOf(b)>-1?e[b](c):e[b].apply(e,c)),c&&c.hasOwnProperty("length")&&c.length>0&&(c=a.util.toArray(c)),d.emit("console",{type:b,message:g||a.stringify.parse(c),stack:h?a.stringify.parse(h):""})}var d=a.console=new a.EventEmitter,e=b.console,f=["dir","dirxml"],g={},h={};d.profiles=[],d.assert=function(b){if(b)c("assert",arguments);else{var d=["Assertion failed:"];d=d.concat(a.util.toArray(arguments).slice(1)),c("assert",arguments,a.stringify.parse(d),a.stacktrace.get())}},d.count=function(a){var b=a||"_GLOBAL_",d=g[b];d?++d.count:g[b]=d={key:a||"",count:1},c("count",arguments,(a||"")+": "+d.count)},d.time=function(a,b){if(!a)return!1;var d="KEY"+a.toString();return!b&&h[d]?!1:(h[d]=(new Date).getTime(),c("time",arguments),void 0)},d.timeEnd=function(a){if(!a)return!1;var b="KEY"+a.toString(),d=h[b];d&&(delete h[b],c("timeEnd",arguments,a+": "+((new Date).getTime()-d)+"ms"))},d.debug=function(){c("debug",arguments)},d.warn=function(){c("warn",arguments)},d.info=function(){c("info",arguments)},d.log=function(){c("log",arguments)},d.dir=function(a){c("dir",a)},d.dirxml=function(b){var d,e=b.nodeType;9===e&&(b=b.documentElement),d=b?b.outerHTML||b.innerHTML||b.toString()||a.stringify.parse(b):null,d&&(d=d.replace(/</gim,"&lt;"),d=d.replace(/>/gim,"&gt;")),c("dirxml",b,d)},d.group=function(){c("group",arguments)},d.groupCollapsed=function(){c("groupCollapsed",arguments)},d.groupEnd=function(){c("groupEnd")},d.markTimeline=function(){c("markTimeline",arguments)},d.timeStamp=function(){c("timeStamp",arguments)},d.profile=function(){c("profile",arguments)},d.profileEnd=function(){c("profileEnd",arguments)},d.error=function(b){c("error",arguments,null,a.stacktrace.get(b))},d.exception=function(){c("error",arguments)},d.trace=function(){c("trace",arguments,null,a.stacktrace.get())},d.clear=function(){g={},h={},c("clear",arguments)},d.command=function(){c("command",arguments)},b.console=d}("undefined"!=typeof ConsoleIO?ConsoleIO:module.exports,this),function(a,b){function c(b,c,d){a.name||(a.name=b.name,a.storage.addItem("deviceName",b.name,365)),b.serialNumber===a.serialNumber&&a.transport.showInfoBar(c,d)}function d(){return Function.prototype.bind?!1:(Function.prototype.bind=function(a){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var b=Array.prototype.slice.call(arguments,1),c=this,d=function(){},e=function(){return c.apply(this instanceof d&&a?this:a,b.concat(Array.prototype.slice.call(arguments)))};return d.prototype=this.prototype,e.prototype=new d,e},void 0)}function e(){var b=[],c=new RegExp("((http|https)://)?([^/]+)","img");return a.util.forEach(a.util.toArray(document.styleSheets),function(d){try{var e=d.cssRules||d.rules,f=d.href.match(c);f.pop(),e&&a.util.forEach(a.util.toArray(e),function(a){var c=a.cssText,d=f.concat();c&&(c.indexOf("../")>-1&&(d.pop(),c=c.replace("..",d.join("/"))),b.push(c))})}catch(g){}}),b.join(" ")}function f(b,c){return b=b||document.body,c=c||b.cloneNode(!0),a.util.forEach(a.util.toArray(b.children),function(a,b){f(a,c.children[b])}),c.setAttribute("style","none"!==b.style.display?a.util.getAppliedStyles(b):"display:none;"),c}function g(){var a;if(b.XMLHttpRequest){a=new XMLHttpRequest;try{a.withCredentials=!1}catch(c){}}else b.XDomainRequest?a=new XDomainRequest:b.ActiveXObject&&(a=new ActiveXObject("Microsoft.XMLHTTP"));return a}function h(b){b&&a.web.setConfig(b)}function i(b){"undefined"!=typeof b.enabled&&(b.enabled?a.web.enabled():a.web.disabled()),h(b.config)}function j(b){var c;try{return c=new Function([],"return "+b),c()}catch(d){a.console.error(d,c&&c.toString?c.toString():void 0)}}function k(c){var d,e;if(c&&(d=j(c)))for(e in d)d.hasOwnProperty(e)&&!A[e]&&(A[e]=d[e]);A.configure&&A.configure(a,b)}function l(b,c){for(var d=c.content,e=d.length,f=a.getConfig(),g=0;e>g;)m(b,c,d.substr(g,f.maxDataPacketSize),g,e),0===g?g=f.maxDataPacketSize:g+=f.maxDataPacketSize}function m(b,c,d,e,f){var g=function(a,b,c,d,e,f){return function(){var g=a.util.extend({},c);g.content=d,g.start=e,g.length=f,a.transport.emit(b,g)}}(a,b,c,d,e,f);setTimeout(g,100)}function n(b){c(b,"registration"),k(b.client),a.console.log("Registration",a.name)}function o(b){c(b,"ready"),i(b.web),A.configure||k(b.client),a.console.log("Ready",a.name)}function p(b){b.serialNumber===a.serialNumber&&(c(b,"online",!0),i(b.web),A.configure||k(b.client),a.transport.clearPendingQueue(),a.console.log("Online",a.name))}function q(b){b.serialNumber===a.serialNumber&&(c(b,"offline"),a.console.log("Offline",a.name))}function r(b){b.serialNumber===a.serialNumber&&(c(b,"client disconnect"),a.console.log("client disconnected",a.serialNumber),a.transport.forceReconnect())}function s(b){b.name||a.storage.removeItem("deviceName"),a.name=b.name,a.storage.addItem("deviceName",a.name,365),a.transport.showInfoBar("new name",!0)}function t(b){try{var c=g(),d=a.util.getUrl("proxy"),e=b.originalURL||b.url;c?(c.open("GET",b.url,!0),c.onreadystatechange=function(){if(4===c.readyState){var a;a=200===c.status?c.responseText:c.statusText,l("source",{url:e,content:a})}},c.onloadend=function(b){a.console.info("file:onLoadEnd",b)},c.onloadstart=function(b){a.console.info("file:onLoadStart",b)},c.onprogress=function(b){a.console.info("file:onProgress",b)},c.onload=function(b){a.console.info("file:onLoad",b)},c.onerror=function(c){-1===b.url.indexOf(d)?(b.originalURL=b.url,b.url=d+"?url="+encodeURIComponent(b.url),t(b)):(a.console.exception("file:onError",c),a.transport.emit("source",{url:e,content:"XMLHttpRequest Error: Possibally Access-Control-Allow-Origin security issue."}))},c.send(null)):a.transport.emit("source",{url:e,content:"XMLHttpRequest request not supported by the browser."})}catch(f){a.console.error(f)}}function u(){a.console.log("Reloading..."),b.setTimeout(function(a){return function(){b.location.reload?b.location.reload(!0):b.location.assign(a)}}(location.href),100)}function v(){a.web.hide(),l("content",{content:document.documentElement.innerHTML}),a.web.show()}function w(){a.web.hide(),a.transport.emit("previewContent",{content:'<html><head><style type="text/css">'+e()+"</style></head>"+f().outerHTML+"</html>"}),a.web.show()}function x(){d(),a.util.requireScript(a.util.getUrl("html2canvas"),function(){a.web.hide(),b.html2canvas(document.body,{completed:!1,logging:!0,useCORS:!0,proxy:a.util.getUrl("proxy"),onrendered:function(b){if(!this.completed)try{this.completed=!0,a.transport.emit("screenShot",{screen:b.toDataURL()})}catch(c){a.transport.emit("screenShot",{screen:!1}),a.console.exception(c)}a.web.show()}})})}function y(){var b=[],c=[],d=a.util.getOrigin();a.util.forEach(a.util.getScripts(),function(a){a.src&&b.push(a.src.replace(d,""))}),b.length>0&&a.transport.emit("files",{type:"javascript",files:b}),a.util.forEach(a.util.getStyles(),function(a){a.href&&c.push(a.href.replace(d,""))}),c.length>0&&a.transport.emit("files",{type:"style",files:c})}function z(b){a.console.info("executing...");var c=j(b);"undefined"!=typeof c&&a.console.command(c)}var A=a.client={};A.jsonify=function(b){var c={},d=["Arguments","Array","String","Number","Boolean","Error","ErrorEvent","Object"];return a.util.forEachProperty(b,function(b,e){c[e]=d.indexOf(a.util.getType(b))>-1?a.stringify.parse(b):typeof b}),c},A.getConfig=function(){var c=b.navigator,d={userAgent:c.userAgent,appVersion:c.appVersion,vendor:c.vendor,platform:c.platform,opera:!!b.opera,params:a.getConfig()};return a.serialNumber&&(d.serialNumber=a.serialNumber),a.name&&(d.name=a.name),d},A.register=function(){a.transport.emit("register",A.getConfig())},A.setUp=function(){a.transport.on("device:registration",n),a.transport.on("device:ready",o),a.transport.on("device:online",p),a.transport.on("device:offline",q),a.transport.on("device:disconnect",r),a.transport.on("device:command",z),a.transport.on("device:fileList",y),a.transport.on("device:htmlContent",v),a.transport.on("device:fileSource",t),a.transport.on("device:previewHTML",w),a.transport.on("device:captureScreen",x),a.transport.on("device:reload",u),a.transport.on("device:name",s),a.transport.on("device:web:control",h),a.transport.on("device:web:config",i)}}("undefined"!=typeof ConsoleIO?ConsoleIO:module.exports,this),function(a,b){function c(){var b=a.config||a.util.queryParams();return b.webOnly=b.webOnly===!0||"true"===(b.webOnly||"").toLowerCase(),b.web=b.web===!0||"true"===(b.web||"").toLowerCase(),b.secure=b.secure===!0||"true"===(b.secure||"").toLowerCase(),"undefined"!=typeof b.filters&&(b.filters="string"==typeof b.filters?b.filters.split(","):b.filters),b}function d(c){a.io=c||b.io,a.transport.setUp(),a.client.setUp(),e.web&&a.web.setUp()}var e={url:"",base:"",secure:!1,html2canvas:"plugins/html2canvas.js","socket.io":"socket.io/socket.io.js",webStyle:"console.css",proxy:"proxy",maxDataPacketSize:5e3,nativeConsole:!0,web:!1,webOnly:!1,consoleId:"consoleioweb",docked:!1,position:"bottom",height:"300px",width:"99%"};a.configure=function(c){if(a.util.extend(e,c),e.webOnly)a.web.setUp();else if(!a.util.isIFrameChild()){if(b.io)return d(),!1;a.util.foundRequireJS()?b.require(["socket.io"],d):a.util.require(a.util.getUrl("socket.io"),d)}},a.getConfig=function(){return e},a.styleSheet=function(){var a=document.createElement("style");return a.type="text/css",a.id="console.io.style",a.appendChild(document.createTextNode("")),document.getElementsByTagName("head")[0].appendChild(a),a.sheet||a.styleSheet}(),a.debug=function(b){var c,d=document.getElementById("log");!d&&document.body&&(d=document.createElement("ul"),d.setAttribute("id","log"),d.style.position="absolute",d.style.background="rgb(48, 46, 46)",d.style.height="200px",d.style.width="800px",d.style.top="20px",d.style.left="50px",d.style.margin="10px",d.style.paddingTop="10px",d.style.zIndex=6e3,document.body.insertBefore(d,a.util.getFirstElement(document.body))),d&&(c=document.createElement("li"),c.innerHTML=b,d.insertBefore(c,a.util.getFirstElement(d)))};var f=b.onerror;b.onerror=function(b,c,d){var e=!1;return f&&(e=f(b,c,d)),a.transport.isConnected()?a.transport.emit("console",{type:"error",message:b+";\nfileName: "+c+";\nlineNo: "+d}):a.util.isIFrameChild()?a.console.exception(b+";\nfileName: "+c+";\nlineNo: "+d):a.debug([b,c,d].join("; ")),e},a.util.foundRequireJS()&&(b.requirejs.onError=function(b){a.console.error(b,b.requireModules,b.originalError)}),b.navigator.userAgent.search(/Maple/i)>-1&&"function"==typeof HTMLElement.prototype.addEventListener&&"function"==typeof HTMLElement.prototype.attachEvent&&(HTMLElement.prototype.attachEvent=void 0),Function.prototype.bind&&b.console&&"object"==typeof b.console.log&&a.util.forEach(["log","info","warn","error","assert","dir","clear","profile","profileEnd"],function(a){b.console[a]=this.bind(b.console[a],b.console)},Function.prototype.call),a.util.isIFrameChild()&&b.parent.postMessage&&a.console.on("console",function(a){b.parent.postMessage({event:"console",type:a.type,message:escape(a.message),stack:a.stack},"*")}),a.util.foundRequireJS()||a.util.ready(function(){a.configure(c())})}("undefined"!=typeof ConsoleIO?ConsoleIO:module.exports,this),function(a,b){function c(){this.store={added:[],queue:[]},this.config=a.util.extend({docked:!1,position:"bottom",height:"300px",width:"99%"},a.getConfig()),this.control={pageSize:this.config.pageSize||50,filters:this.config.filters||[],paused:!1,search:null},this.config.search&&this.applySearch(this.config.search),this.isEnabled=!1,this.view=new d(this)}function d(a){this.ctrl=a,this.elements={},this.target=null,this.container=null}var e=a.web={};c.prototype.setUp=function(){var b=this;a.util.requireCSS(a.util.getUrl("webStyle"),function(){b.enabled()})},c.prototype.enabled=function(){this.isEnabled||(this.isEnabled=!0,this.view.render(document.body),a.console.on("console",a.web.logger),b.addEventListener?b.addEventListener("message",a.web.onMessage,!1):b.detachEvent&&b.detachEvent("onmessage",a.web.onMessage),a.transport.emit("webStatus",{enabled:!0}))},c.prototype.disabled=function(){this.isEnabled&&(this.isEnabled=!1,a.console.removeListener("console",a.web.logger),b.removeEventListener?b.removeEventListener("message",a.web.onMessage,!1):b.attachEvent&&b.attachEvent("onmessage",a.web.onMessage),a.transport.emit("webStatus",{enabled:!1}),this.view.destroy())},c.prototype.setControl=function(a){"undefined"!=typeof a.paused&&(this.control.paused=a.paused),"undefined"!=typeof a.filters&&(this.control.filters=a.filters),a.pageSize!==this.control.pageSize&&(this.control.pageSize=a.pageSize),a.search!==this.control.search&&this.applySearch(a.search),this.view.clear(),a.clear||(this.view.addBatch(this.getData(this.store.added)),this.addBatch())},c.prototype.getData=function(b){var c=0,d=[];return b.length>0&&a.util.every([].concat(b).reverse(),function(a){return this.isFiltered(a)&&this.isSearchFiltered(a)&&(d.push(a),c++),this.control.pageSize>c},this),d},c.prototype.hide=function(){return this.view.hide()},c.prototype.show=function(){return this.view.show()},c.prototype.add=function(a){this.control.paused?this.store.queue.push(a):(this.store.added.push(a),this.view.add(a))},c.prototype.addBatch=function(){this.control.paused||(this.view.addBatch(this.getData(this.store.queue)),this.store.added=this.store.added.concat(this.store.queue),this.store.queue=[])},c.prototype.applySearch=function(a){this.control.search="undefined"!=typeof a?a:null,this.control.search&&(this.control.search="\\"!==this.control.search[0]?new RegExp("\\b"+this.control.search,"img"):new RegExp(this.control.search,"img"))},c.prototype.isSearchFiltered=function(a){return this.control.search?a.message.search(this.control.search)>-1:!0},c.prototype.isFiltered=function(a){return 0===this.control.filters.length||this.control.filters.length>0&&this.control.filters.indexOf(a.type)>-1},d.prototype.render=function(a){this.target=a,this.createContainer()},d.prototype.reload=function(){this.clear(),this.container.parentNode.removeChild(this.container),this.createContainer()},d.prototype.destroy=function(){this.container&&(this.clear(),this.container.parentNode&&(this.container.parentNode.removeChild(this.container),this.container=null,this.target=null))},d.prototype.hide=function(){this.target&&this.container&&this.target.removeChild(this.container)
},d.prototype.show=function(){this.target&&this.container&&(this.ctrl.config.position&&"top"===this.ctrl.config.position?this.target.insertBefore(this.container,a.util.getFirstElement(this.target)):this.target.appendChild(this.container))},d.prototype.createContainer=function(){if(this.container)return!1;var b=["background-color: rgba(244, 244, 244, 0.9)","color: black","z-index: 5000","overflow: auto","margin: 5px","-o-box-shadow: 0 0 5px 1px #888","-moz-box-shadow: 0 0 5px 1px #888","-webkit-box-shadow: 0 0 5px 1px #888","box-shadow: 0 0 5px 1px #888"];switch(this.ctrl.config.docked||b.push("position:absolute"),this.ctrl.config.height&&b.push("height:"+this.ctrl.config.height),this.ctrl.config.width&&b.push("width:"+this.ctrl.config.width),this.ctrl.config.position.toLowerCase()){case"top":b.push("top: 5px");break;default:b.push("bottom: 5px")}var c=a.getConfig();a.util.deleteCSSRule(a.styleSheet,"#"+c.consoleId),a.util.addCSSRule(a.styleSheet,"#"+c.consoleId,b.join(";")),this.container=this.createElement({attr:{id:c.consoleId,tabindex:1},target:this.target,position:this.ctrl.config.position})},d.prototype.createElement=function(b){b.tag=b.tag||"div",this.elements[b.tag]||(this.elements[b.tag]=document.createElement(b.tag));var c=this.elements[b.tag].cloneNode(!1);return a.util.forEachProperty(b.attr,function(a,b){a&&c.setAttribute(b,a)}),a.util.forEachProperty(b.prop,function(a,b){a&&(c[b]=a)}),b.target&&(b.position&&"top"===b.position?b.target.insertBefore(c,a.util.getFirstElement(b.target)):b.target.appendChild(c)),c},d.prototype.stripBrackets=function(a){var b=a.length-1;return"["===a.charAt(0)&&"]"===a.charAt(b)?a.substring(1,b):a},d.prototype.getElementData=function(b){var c,d,e="code",f=b.type,g=b.origin,h=this.stripBrackets(b.message);if("assert"===b.type){var i=this.stripBrackets(h).split(",");"true"!==i[0].toLowerCase()&&(f="assert-failed")}if(h=h.replace(/%20/gim," "),h.indexOf("{")>-1&&h.indexOf("}")>-1&&(e="pre"),b.stack){var j=b.stack.split(",").join("\n").replace(/"/gim,"").replace(/%20/gim," ");d=this.stripBrackets(j),h+="\n"+d}return["assert","dir","dirxml","error","trace"].indexOf(b.type)>-1&&(e="pre"),g&&(g=b.origin.replace(/(\/|:|\.)/gim,""),c="content: 'iframe:"+b.origin+"'; position: absolute; top: 0px; right: 0px; padding: 2px 8px; "+"font-size: 12px; color: lightgrey !important; "+"background-color: black; "+"font-family: Monaco,Menlo,Consolas,'Courier New',monospace;",a.util.deleteCSSRule(a.styleSheet,"."+g+":before"),a.util.addCSSRule(a.styleSheet,"."+g+":before",c)),{tag:e,className:"console type-"+f+(g?" "+g:""),message:h||"."}},d.prototype.add=function(a){if(!this.ctrl.isFiltered(a)||!this.ctrl.isSearchFiltered(a)||!this.container)return!1;var b=this.getElementData(a);this.createElement({tag:b.tag,attr:{"class":b.className},prop:{innerHTML:b.message},target:this.container,position:"top"}),this.removeOverflowElement()},d.prototype.addBatch=function(b){if(b.length>0&&this.container){var c=document.createDocumentFragment();a.util.forEach(b,function(a){var b=this.getElementData(a);this.createElement({tag:b.tag,attr:{"class":b.className},prop:{innerHTML:b.message},target:c,position:"bottom"})},this),this.container.insertBefore(c,a.util.getFirstElement(this.container)),this.removeOverflowElement()}},d.prototype.clear=function(){if(this.container)for(;this.container.firstChild;)this.container.removeChild(this.container.firstChild)},d.prototype.removeOverflowElement=function(){for(var a=this.container.childElementCount||this.container.children.length;a>this.ctrl.control.pageSize;)this.container.removeChild(this.container.lastElementChild||this.container.lastChild),a--},e.logger=function(b){a.web.console&&a.web.console.add(b)},e.onMessage=function(b){if(a.web.console){var c=b.data;"console"===c.event&&a.web.console.add({type:c.type,message:unescape(c.message),stack:c.stack,origin:b.origin})}},e.setUp=function(){e.console||(e.console=new c),e.console.setUp()},e.enabled=function(){e.console?e.console.enabled():e.setUp()},e.disabled=function(){e.console&&e.console.disabled()},e.setConfig=function(b){e.console&&e.console.setControl(b);var c=[a.name||"",a.serialNumber||"",a.transport.isConnected()?"online":"offline"];b.paused&&c.push("paused"),b.filters&&b.filters.length>0&&c.push("filters:"+b.filters.join(",")),b.pageSize&&c.push("pagesize:"+b.pageSize),b.search&&c.push("search:"+b.search),a.util.showInfo(c.join("|"),a.transport.isConnected())},e.show=function(){return e.console?e.console.show():void 0},e.hide=function(){return e.console?e.console.hide():void 0}}("undefined"!=typeof ConsoleIO?ConsoleIO:module.exports,this),"function"==typeof define&&define.amd&&define([],function(){return ConsoleIO})}();